
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MOUHIHA Mohamedis the personal website of Mr. MOUHIHA Mohamed where he shares the projects he is working on,  the machine learning books he has read and also free courses on the main points of machine learning and deep learning.">
      
      
      
      
        <link rel="prev" href="../projet%20R/">
      
      
        <link rel="next" href="../Painting%20Vermeer/">
      
      <link rel="icon" href="../../logo.jpg">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.19">
    
    
      
        <title>Reciprocal n-body Collision Avoidance - MOUHIHA Mohamed</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/fonts.css">
    
      <link rel="stylesheet" href="../../stylesheets/home/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/home/about.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   
  
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="MOUHIHA Mohamed - Reciprocal n-body Collision Avoidance" />
<meta property="og:description" content="" />

<meta property="og:url" content="None" />
<meta property="og:image" content="https://www.msys2.org/logo.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="250" />
<script type="application/ld+json">
  {
    "image": "https://www.msys2.org/logo.png",
    "@type": "WebSite",
    "headline": "MSYS2",
    "publisher": {
      "@type": "Organization",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.msys2.org/logo.png"
      }
    },
    "url": "https://www.msys2.org",
    "description": "Software Distribution and Building Platform for Windows",
    "name": "MSYS2",
    "@context": "https://schema.org"
  }
</script>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reciprocal-n-body-collision-avoidance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MOUHIHA Mohamed" class="md-header__button md-logo" aria-label="MOUHIHA Mohamed" data-md-component="logo">
      
  <img src="../../logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MOUHIHA Mohamed
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reciprocal n-body Collision Avoidance
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mouhihamohamed702/mouhihaMohamed702" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../spam%20datasets/" class="md-tabs__link md-tabs__link--active">
        Projects
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Documentations/Libraries/" class="md-tabs__link">
        Documentations
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../books/not%20yet/" class="md-tabs__link">
      Books
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../services/documentation/" class="md-tabs__link">
      Services
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MOUHIHA Mohamed" class="md-nav__button md-logo" aria-label="MOUHIHA Mohamed" data-md-component="logo">
      
  <img src="../../logo.jpg" alt="logo">

    </a>
    MOUHIHA Mohamed
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mouhihamohamed702/mouhihaMohamed702" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Projects
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Projects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spam%20datasets/" class="md-nav__link">
        Spam Dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ozone%20datasets/" class="md-nav__link">
        Ozone Dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../boston%20datasets/" class="md-nav__link">
        Boston Dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tp_gnn/" class="md-nav__link">
        TP_GNN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../abstractive%20summarization/" class="md-nav__link">
        Abstractive Summarization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../big%20data%20for%20iot/" class="md-nav__link">
        Big-Data For IoT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../projet%20R/" class="md-nav__link">
        Profilage des chauffeurs
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Reciprocal n-body Collision Avoidance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Reciprocal n-body Collision Avoidance
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#importer-les-packages" class="md-nav__link">
    Importer les Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialiser-la-geometrie" class="md-nav__link">
    Initialiser la géométrie
  </a>
  
    <nav class="md-nav" aria-label="Initialiser la géométrie">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#draw" class="md-nav__link">
    draw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record_video" class="md-nav__link">
    record_video
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_indivn" class="md-nav__link">
    generate_indiv(N)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximini-plot_directions" class="md-nav__link">
    maxiMini &amp; plot_directions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exit" class="md-nav__link">
    Exit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obstacle" class="md-nav__link">
    Obstacle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obstacle_cir" class="md-nav__link">
    Obstacle_Cir
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fast-marching" class="md-nav__link">
    Fast Marching
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#myagent" class="md-nav__link">
    MyAgent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fonctions" class="md-nav__link">
    Fonctions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#champs-de-directions" class="md-nav__link">
    Champs de directions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    Simulation
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Painting%20Vermeer/" class="md-nav__link">
        Algorithmes Génétiques 2, Peindre Vermeer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Documentations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Documentations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Documentations/Libraries/">Libraries</a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Libraries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Documentations/Libraries/numpy/" class="md-nav__link">
        NumPy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Documentations/Libraries/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Documentations/Machine%20Learning%20Algorithms/">Machine Learning Algorithms</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Machine Learning Algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Documentations/Computer%20Vision%20Algorithms/">Computer Vision Algorithms</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Computer Vision Algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Documentations/Computer%20Vision%20Algorithms/yolonas/" class="md-nav__link">
        YOLO-NAS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../books/not%20yet/" class="md-nav__link">
        Books
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../services/documentation/" class="md-nav__link">
        Services
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#importer-les-packages" class="md-nav__link">
    Importer les Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialiser-la-geometrie" class="md-nav__link">
    Initialiser la géométrie
  </a>
  
    <nav class="md-nav" aria-label="Initialiser la géométrie">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#draw" class="md-nav__link">
    draw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record_video" class="md-nav__link">
    record_video
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_indivn" class="md-nav__link">
    generate_indiv(N)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximini-plot_directions" class="md-nav__link">
    maxiMini &amp; plot_directions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exit" class="md-nav__link">
    Exit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obstacle" class="md-nav__link">
    Obstacle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obstacle_cir" class="md-nav__link">
    Obstacle_Cir
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fast-marching" class="md-nav__link">
    Fast Marching
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#myagent" class="md-nav__link">
    MyAgent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fonctions" class="md-nav__link">
    Fonctions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#champs-de-directions" class="md-nav__link">
    Champs de directions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    Simulation
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/mouhihamohamed702/mouhihaMohamed702/edit/source/web/projects/Reciprocal-n-body-Collision-Avoidance.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="reciprocal-n-body-collision-avoidance">Reciprocal n-body Collision Avoidance</h1>
<h2 id="importer-les-packages"><strong>Importer les Packages</strong></h2>
<ul>
<li>
<p><a href="https://numpy.org/">NumPy</a> : NumPy est une bibliothèque Python populaire pour le calcul scientifique qui fournit des structures de données pour la représentation de tableaux multidimensionnels et des fonctions pour manipuler ces tableaux.</p>
</li>
<li>
<p><a href="https://matplotlib.org/">Matplotlib</a> : Matplotlib est une bibliothèque en Python utilisée pour tracer des graphiques et des visualisations.</p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/heapq.html">heapq</a> : heapq est un module Python qui implémente les algorithmes d'heaps ou de tas pour des structures de données.</p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/math.html">math</a> : Le module math en Python fournit des fonctions mathématiques courantes, telles que les fonctions trigonométriques, exponentielles, logarithmiques, etc.</p>
</li>
<li>
<p><a href="https://cvxopt.org/">CVXOPT</a> : CVXOPT est une bibliothèque open source Python pour l'optimisation convexe. Elle est utilisée pour résoudre des problèmes d'optimisation convexe tels que la programmation linéaire, la programmation quadratique, la programmation semi-définie, la programmation convexe et autres. Elle fournit des solveurs rapides et précis pour les problèmes d'optimisation convexe, y compris des interfaces pour les solvers externes.</p>
</li>
<li>
<p><a href="https://www.geeksforgeeks.org/python-random-module/">random</a> : The random module in Python provides a suite of functions for generating random numbers.</p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/time.html">time</a> : Le module time est un module Python qui fournit diverses fonctions permettant de manipuler le temps.</p>
</li>
<li>
<p><a href="https://docs.opencv.org/4.x/d6/d00/tutorial_py_root.html">cv2</a> : cv2 is a library for computer vision and image processing. It is a Python wrapper for OpenCV (Open Source Computer Vision), which is a C++ library that includes numerous computer vision algorithms.</p>
</li>
<li>
<p><a href="https://ipython.org/">IPython</a> : La bibliothèque IPython fournit un certain nombre d'outils pour faciliter le développement et l'analyse de données en Python.</p>
</li>
<li>
<p><a href="https://tqdm.github.io/">tqdm</a> : tqdm is a Python package that provides a progress bar visualization for iterative tasks, making it easy to see how far along a task is and how much longer it is expected to take.</p>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Packages</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">dot</span><span class="p">,</span><span class="n">array</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Circle</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">show</span><span class="p">,</span><span class="n">imshow</span>
<span class="kn">import</span> <span class="nn">heapq</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">cvxopt</span>
<span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">matrix</span><span class="p">,</span><span class="n">solvers</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</code></pre></div></td></tr></table></div>
<h2 id="initialiser-la-geometrie"><strong>Initialiser la géométrie</strong></h2>
<h3 id="draw"><strong>draw</strong></h3>
<p>On commence par définir la fonction <code>draw</code> qui prend plusieurs arguments en entrée et qui trace une scène avec des agents et des obstacles.</p>
<p>Les arguments en entrée sont:</p>
<p><strong><code>Ex</code> :</strong> une liste des sorties de la scène</p>
<p><strong><code>Obs</code> :</strong> une liste des obstacles rectangulaires</p>
<p><strong><code>Obs_cir</code> :</strong> une liste des obstacles circulaires</p>
<p><strong><code>scene</code> :</strong> une paire (L, l) qui représente les dimensions de la scène</p>
<p><strong><code>agents</code> :</strong> une liste d'agents, où chaque agent est représenté par sa position, sa taille et sa couleur</p>
<p><strong><code>t</code> :</strong> temps de simulation</p>
<p><strong><code>savepath</code> :</strong> le chemin pour enregistrer la figure générée</p>
<p><strong><code>play</code> :</strong> un booléen qui spécifie si l'animation doit être affichée ou non</p>
<p>La fonction commence par créer une figure et un axe avec une taille déterminée par la dimension de la scène. Ensuite, elle dessine les obstacles, les sorties et les agents sur la figure. Les obstacles rectangulaires sont représentés par des rectangles noirs, les obstacles circulaires par des cercles noirs, les sorties par des rectangles orange et les agents par des cercles de couleur.</p>
<p>Enfin, la fonction sauvegarde la figure à l'emplacement spécifié par "savepath". Si "play" est faux, la figure est fermée.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">draw</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Obs</span><span class="p">,</span> <span class="n">Obs_cir</span><span class="p">,</span> <span class="n">scene</span><span class="p">,</span> <span class="n">agents</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">savepath</span><span class="p">,</span> <span class="n">play</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

    <span class="n">L</span> <span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">scene</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">l</span><span class="o">/</span><span class="n">L</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">ratio</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="s2">&quot;Temps de simulation : </span><span class="si">%s</span><span class="s2"> s </span><span class="se">\n</span><span class="s2"> Nombre des agents : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)),</span> 
                    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="c1">#Draw the environment</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">],</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">l</span><span class="p">,</span><span class="n">l</span><span class="p">],</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">l</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>


    <span class="c1">#Draw Obstacle</span>
    <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">Obs</span><span class="p">:</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obs</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obs</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

    <span class="c1">#Draw Obstacle Cir</span>
    <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">Obs_cir</span><span class="p">:</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obs</span><span class="o">.</span><span class="n">rayon</span><span class="p">)</span>
        <span class="n">circle</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

    <span class="c1">#Draw exits</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Ex</span><span class="p">:</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

    <span class="c1">#Draw agents</span>
    <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">position</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">agent</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">circle</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">play</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="record_video"><strong>record_video</strong></h3>
<p>La fonction appelée <code>record_video</code> prend un argument optionnel speed (dont la valeur par défaut est 25). Le but de cette fonction est de créer une vidéo à partir d'une séquence d'images sauvegardées dans un répertoire, et de sauvegarder le fichier vidéo résultant dans le répertoire de travail actuel. Les arguments passés à cette fonction sont les suivants :</p>
<p><strong><code>speed</code> :</strong> une valeur entière représentant le nombre d'images par seconde de la vidéo résultante (c'est-à-dire le taux de rafraîchissement de la vidéo).</p>
<p>La fonction commence par imprimer un message indiquant qu'elle commence l'enregistrement de la vidéo. Ensuite, elle lit la première image de la séquence d'images pour déterminer les dimensions de la vidéo.</p>
<p>Elle crée ensuite un objet VideoWriter en utilisant la méthode <strong>cv2.VideoWriter</strong> d'OpenCV, en spécifiant le nom du fichier de sortie, le codec vidéo (dans ce cas <strong>XVID</strong>), le taux de rafraîchissement et les dimensions de la vidéo (basées sur les dimensions de la première image).</p>
<p>Ensuite, elle boucle sur les images restantes de la séquence et ajoute chacune à la vidéo à l'aide de la méthode <strong>video.write()</strong>. Les images sont lues en utilisant la méthode <strong>cv2.imread()</strong> d'OpenCV, qui lit une image à partir d'un chemin de fichier spécifié.</p>
<p>Enfin, la fonction nettoie toutes les fenêtres qui ont pu être créées pendant le processus et libère l'objet vidéo. Elle affiche un message indiquant que la vidéo a été sauvegardée.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">record_video</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">record_video</span><span class="p">(</span><span class="n">speed</span> <span class="o">=</span> <span class="mi">25</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recording video ...&#39;</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;DossierImages/simulation&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">)</span>
    <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">layers</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;XVID&#39;</span><span class="p">)</span>
    <span class="n">video</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="s1">&#39;video.avi&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_iter</span><span class="p">):</span>
        <span class="n">video</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;DossierImages/simulation&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">))</span>

    <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
    <span class="n">video</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Video saved.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="generate_indivn"><strong>generate_indiv(N)</strong></h3>
<p>La fonction <code>generate_indiv(N)</code> crée une liste de N agents en vérifiant qu'ils ne se chevauchent pas et ne traversent pas les obstacles. Voici les étapes principales :</p>
<ul class="task-list">
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> La fonction définit la taille de la scène, ainsi que des variables pour la distance minimale entre les agents et pour le rayon de chaque agent.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> La fonction crée une liste vide L qui contiendra les agents, puis elle commence une boucle qui s'arrêtera quand il y aura N agents dans la liste L.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> À chaque itération de la boucle, la fonction génère une position aléatoire pour un nouvel agent en utilisant des fonctions aléatoires et l'ajoute à une liste temporaire q, qui contient les positions de tous les agents déjà créés, ainsi que les rayons de ces agents, qui sont stockés dans la liste R.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Ensuite, la fonction vérifie s'il y a une collision entre le nouvel agent et les agents déjà créés. Si c'est le cas, la variable choc est définie sur True, ce qui signifie qu'il y a eu une collision et que le nouvel agent ne sera pas ajouté à la liste L.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Ensuite, la fonction vérifie si le nouvel agent entre en collision avec un obstacle. Si c'est le cas, la variable choc est définie sur True.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Si le nouvel agent ne provoque pas de collision, il est ajouté à la liste L.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Lorsque N agents ont été créés et ajoutés à la liste L, la fonction retourne cette liste.</p>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">generate_indiv</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_indiv</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">rand_float_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="n">start</span>

    <span class="n">a</span> <span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">size_scene</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>

        <span class="n">choc</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="n">agent</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">agent</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">rand_float_range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rand_float_range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

        <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
        <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">dst</span><span class="p">:</span>
                <span class="n">choc</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

        <span class="c1">#chocs obstacle</span>
        <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles_cir</span><span class="p">:</span>
            <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">],</span> <span class="n">rayon</span> <span class="o">=</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">rayon</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">b0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">rayon</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">:</span> <span class="n">choc</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
            <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">],</span> <span class="n">w</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">height</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">w</span> <span class="p">,</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">l</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">a0</span><span class="o">&lt;=</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">a1</span> <span class="ow">and</span> <span class="n">b0</span><span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">b1</span><span class="o">+</span><span class="n">r</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">b0</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">b1</span> <span class="ow">and</span> <span class="n">a0</span><span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;=</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">a1</span><span class="o">+</span><span class="n">r</span><span class="o">+</span><span class="mf">0.5</span><span class="p">):</span> <span class="n">choc</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">distance_vecteur_obs</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span> <span class="n">choc</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">choc</span><span class="p">:</span>
            <span class="n">agent</span> <span class="o">=</span> <span class="n">myAgent</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">r</span>
            <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">L</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="maximini-plot_directions"><strong>maxiMini &amp; plot_directions</strong></h3>
<p>La première fonction, nommée <code>maxiMini(FX,FY)</code>, prend en entrée deux listes <strong>FX</strong> et <strong>FY</strong>, contenant des valeurs de directions. Cette fonction parcourt les deux listes et recherche la valeur maximale et la valeur minimale des directions dans chaque liste. Elle retourne ensuite ces deux valeurs.</p>
<p>La deuxième fonction, nommée <code>plot_directions(FX,FY)</code>, prend également en entrée deux listes <strong>FX</strong> et <strong>FY</strong>. Cette fonction affiche deux graphiques côte à côte : un pour les directions selon X et un pour les directions selon Y. Les directions sont représentées par des couleurs sur chaque graphique, et les couleurs correspondent à des valeurs. Les valeurs minimales et maximales sont obtenues en appelant la fonction <code>maxiMini(FX,FY)</code>. Les graphiques sont affichés à l'aide de la bibliothèque Matplotlib. Enfin, cette fonction retourne les graphiques affichés.</p>
<p>En résumé, ces deux fonctions permettent de visualiser les directions de mouvement à partir de listes de directions selon X et Y.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">maxiMini & plot_directions</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">maxiMini</span><span class="p">(</span><span class="n">FX</span><span class="p">,</span><span class="n">FY</span><span class="p">):</span>
  <span class="n">maxi</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">Mini</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FX</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
      <span class="n">fx</span> <span class="p">,</span> <span class="n">fy</span> <span class="o">=</span> <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="p">,</span> <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">fx</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fx</span> <span class="o">!=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">!=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">fy</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fx</span><span class="o">&gt;</span><span class="n">maxi</span> <span class="p">:</span>
          <span class="n">maxi</span> <span class="o">=</span> <span class="n">fx</span>
        <span class="k">if</span> <span class="n">fy</span><span class="o">&gt;</span><span class="n">maxi</span> <span class="p">:</span>
          <span class="n">maxi</span> <span class="o">=</span> <span class="n">fy</span>
        <span class="k">if</span> <span class="n">fx</span><span class="o">&lt;</span><span class="n">Mini</span> <span class="p">:</span> 
          <span class="n">Mini</span> <span class="o">=</span> <span class="n">fx</span>
        <span class="k">if</span> <span class="n">fy</span><span class="o">&lt;</span><span class="n">Mini</span> <span class="p">:</span>
          <span class="n">Mini</span> <span class="o">=</span> <span class="n">fy</span>

  <span class="k">return</span> <span class="n">maxi</span> <span class="p">,</span> <span class="n">Mini</span>

<span class="k">def</span> <span class="nf">plot_directions</span><span class="p">(</span><span class="n">FX</span><span class="p">,</span><span class="n">FY</span><span class="p">):</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
  <span class="n">Z</span> <span class="o">=</span> <span class="p">[</span><span class="n">FX</span><span class="p">,</span> <span class="n">FY</span><span class="p">]</span>
  <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Directions selon X&#39;</span><span class="p">,</span> <span class="s1">&#39;Directions selon Y&#39;</span><span class="p">]</span>
  <span class="n">maxi</span> <span class="p">,</span> <span class="n">Mini</span> <span class="o">=</span> <span class="n">maxiMini</span><span class="p">(</span><span class="n">FX</span><span class="p">,</span><span class="n">FY</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
      <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;bicubic&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">Mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

  <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
  <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="exit"><strong>Exit</strong></h3>
<p>Ce code définit une classe <code>Exit</code> qui représente une sortie. La classe possède un constructeur <strong>(<strong>init</strong>)</strong> qui prend en argument <strong>une position</strong>, <strong>une largeur</strong> et <strong>une hauteur</strong> de la sortie. La position est un tuple de deux éléments représentant les coordonnées (x, y) du coin supérieur gauche de la sortie.</p>
<p>Le constructeur initialise les attributs position, width et height de la classe avec les valeurs passées en argument.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Exit</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Exit</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">position</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="obstacle"><strong>Obstacle</strong></h3>
<p>La classe <code>Obstacle</code> a pour but de représenter un obstacle dans une simulation. Elle possède trois attributs : <strong>position</strong>, <strong>width</strong> et <strong>height</strong>, qui correspondent respectivement à la position de l'obstacle et à sa largeur et hauteur.</p>
<p>La méthode <strong><strong>repr</strong></strong> de la classe est une méthode spéciale qui renvoie une chaîne de caractères représentant l'objet. Dans ce cas précis, elle renvoie une chaîne de caractères contenant la position de l'obstacle ainsi que les coordonnées de ses coins (en supposant que la position correspond au coin en bas à gauche).</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Obstacle</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Obstacle</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">=</span><span class="n">position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="n">height</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Obstacle&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;DL:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;DR:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;UR:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;UL:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="obstacle_cir"><strong>Obstacle_Cir</strong></h3>
<p>Ce code définit une classe <code>Obstacle_Cir</code> qui représente un obstacle circulaire.</p>
<p>La classe a un constructeur <strong><strong>init</strong></strong> qui prend deux paramètres, <strong>position</strong> et <strong>rayon</strong>, qui sont utilisés pour initialiser les attributs de l'objet. L'attribut position est un tuple qui représente la position du centre de l'obstacle sur l'espace de simulation et l'attribut rayon est un nombre flottant qui représente le rayon de l'obstacle.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Obstacle_Cir</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Obstacle_Cir</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span><span class="n">rayon</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">=</span><span class="n">position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rayon</span><span class="o">=</span><span class="n">rayon</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="fast-marching"><strong>Fast Marching</strong></h2>
<div class="admonition note">
<p class="admonition-title">PriorityQueue</p>
<p>Cette classe est une implémentation d'une file de priorité (ou heap) en utilisant la bibliothèque heapq.</p>
<p><strong><em><strong>init</strong>(self) :</em></strong> Constructeur de la classe qui initialise la file de priorité et un index pour suivre l'élément courant.</p>
<p><strong><em>pop(self) :</em></strong> Cette méthode supprime et renvoie l'élément le plus petit de la file de priorité.</p>
<p><strong><em>remove(self, nodeId) :</em></strong> Cette méthode prend un noeud (identifié par nodeId) en entrée et supprime cet élément de la file de priorité.</p>
<p><strong><em><strong>iter</strong>(self) :</em></strong> Cette méthode renvoie l'itérateur sur l'instance de la file de priorité.</p>
<p><strong><em><strong>str</strong>(self) :</em></strong> Cette méthode renvoie une représentation sous forme de chaîne de la file de priorité.</p>
<p><strong><em>append(self, node) :</em></strong> Cette méthode ajoute un élément dans la file de priorité.</p>
<p><strong><em><strong>contains</strong>(self, key) :</em></strong> Cette méthode renvoie True si la clé est présente dans la file de priorité, False sinon.</p>
<p><strong><em><strong>eq</strong>(self, other) :</em></strong> Cette méthode vérifie si deux files de priorité sont égales.</p>
<p><strong><em><strong>getitem</strong>(self, nodeId) :</em></strong> Cette méthode renvoie l'élément correspondant à l'ID du nœud donné.</p>
<p><strong><em>clear(self) :</em></strong> Cette méthode supprime tous les éléments de la file de priorité.</p>
<p><strong><em><strong>len</strong>(self) :</em></strong> Cette méthode renvoie la longueur de la file de priorité.</p>
<p><strong><em><strong>next</strong> = next :</em></strong> Cette méthode est utilisée pour rendre la file de priorité iterable.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PriorityQueue</span><span class="p">():</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodeId</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">nodeId</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span><span class="p">;</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;PQ:[</span><span class="si">%s</span><span class="s1">]&#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">,</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodeId</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">nodeId</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">element</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">)</span>

    <span class="fm">__next__</span> <span class="o">=</span> <span class="nb">next</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">GridGraph</p>
<p>Ce code définit une classe <code>GridGraph</code> qui représente une grille. Cette grille est utilisée pour simuler un environnement dans lequel une ou plusieurs entités se déplacent, en utilisant un algorithme de calcul de chemin pour déterminer le chemin optimal entre deux points.</p>
<p>La classe est initialisée avec deux paramètres, <strong><em>size_scene</em></strong> qui est un tuple représentant la taille de la scène (la grille) en unités arbitraires, et <strong><em>precision</em></strong> qui détermine le nombre de subdivisions dans la grille. La précision est utilisée pour définir la taille de chaque case dans la grille.</p>
<p>La grille est modélisée par deux matrices, <strong><em>indicator_map</em></strong> et <strong><em>distances</em></strong>. indicator_map est initialisée avec des valeurs de 1 pour chaque case de la grille, et sera modifiée plus tard pour inclure des obstacles et des sorties. distances est initialisée avec des valeurs inf pour chaque case de la grille.</p>
<p>La méthode <strong><em>get_neighbours</em></strong> est utilisée pour renvoyer les voisins d'un nœud donné, représenté par un tuple d'entiers (x, y) indiquant les coordonnées du nœud sur la grille.</p>
<p>La méthode <strong><em>to_node</em></strong> est utilisée pour convertir des coordonnées réelles en coordonnées de nœuds sur la grille.</p>
<p>La méthode <strong><em>prepare_graph_for_fast_marching</em></strong> est utilisée pour modifier indicator_map en y ajoutant des obstacles et des sorties, afin de préparer la grille pour l'algorithme de calcul de chemin. Les obstacles sont définis comme des rectangles ou des cercles, représentés par des objets <strong><em>Obstacle</em></strong> ou <strong><em>ObstacleCir</em></strong>, et les sorties sont représentées par des objets <strong><em>Exit</em></strong>.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GridGraph</span><span class="p">:</span>

    <span class="k">global</span> <span class="n">OBSTACLE</span>
    <span class="k">global</span> <span class="n">EXIT</span>
    <span class="n">OBSTACLE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">EXIT</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">size_scene</span><span class="p">,</span><span class="n">precision</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size_scene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">precision</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertical_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size_scene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">precision</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">vertical_size</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontal_size</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distances</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">vertical_size</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontal_size</span><span class="p">))</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">node</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontal_size</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;x+1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;x-1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">vertical_size</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;y+1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;y-1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>

    <span class="k">def</span> <span class="nf">to_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">coordinates</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">prepare_graph_for_fast_marching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obstacles</span><span class="p">,</span> <span class="n">obstacles_cir</span><span class="p">,</span> <span class="n">exits</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
            <span class="n">dl</span> <span class="o">=</span> <span class="p">(</span><span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ur</span> <span class="o">=</span> <span class="p">(</span><span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">obstacle</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">obstacle</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">dl</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">ur</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">dl</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">ur</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">OBSTACLE</span>

        <span class="k">for</span> <span class="n">obstacle_cir</span> <span class="ow">in</span> <span class="n">obstacles_cir</span><span class="p">:</span>
            <span class="n">dl</span> <span class="o">=</span> <span class="p">(</span><span class="n">obstacle_cir</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">rayon</span> <span class="p">,</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">rayon</span><span class="p">)</span>
            <span class="n">ur</span> <span class="o">=</span> <span class="p">(</span><span class="n">obstacle_cir</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">rayon</span> <span class="p">,</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">rayon</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">dl</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">ur</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">dl</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">ur</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">-</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">-</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">obstacle_cir</span><span class="o">.</span><span class="n">rayon</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">OBSTACLE</span>

        <span class="k">for</span> <span class="n">exit_</span> <span class="ow">in</span> <span class="n">exits</span><span class="p">:</span>
            <span class="n">dl</span> <span class="o">=</span> <span class="p">(</span><span class="n">exit_</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">exit_</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ur</span> <span class="o">=</span> <span class="p">(</span><span class="n">exit_</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">exit_</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">exit_</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">exit_</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">dl</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">ur</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">dl</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">(</span><span class="n">ur</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">indicator_map</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">EXIT</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">fast_marching_method</p>
<p>Le code prend en entrée un graphe et un point de départ et retourne une carte de distance de tous les nœuds du graphe au point de départ.</p>
<p>Le code commence par définir une fonction <strong><em>calculus_distance</em></strong> qui prend en entrée un nœud, un graphe et des poids et renvoie la distance de ce nœud au point de départ en utilisant la méthode de marche rapide. Cette méthode calcule la distance en utilisant la distance aux nœuds voisins pondérée par des poids qui dépendent de la géométrie du problème.</p>
<p>Ensuite, le code initialise une file de priorité <strong><em>frontier</em></strong>, qui contiendra les nœuds à explorer, et une liste <strong><em>explored</em></strong> qui contiendra les nœuds déjà explorés. Les poids initiaux des nœuds sont stockés dans <strong><em>weights</em></strong>. Les points d'arrivée sont trouvés dans la carte <strong><em>indicator_map</em></strong> et ajoutés à la file de priorité avec une distance initiale de 0. Les poids des points d'arrivée sont également initialisés à 0.</p>
<p>La boucle principale commence avec l'extraction d'un nœud de la file de priorité frontier. La distance à ce nœud est stockée dans weights. Les voisins du nœud sont explorés, et si un voisin n'a pas déjà été exploré et appartient à la grille (indiqué par la carte indicator_map), sa distance au point de départ est calculée en utilisant la méthode calculus_distance. Si le voisin n'est pas déjà dans la file de priorité, il est ajouté avec sa nouvelle distance, sinon, si sa distance calculée est inférieure à sa distance actuelle, sa distance et sa priorité dans la file de priorité sont mises à jour. Les nœuds explorés sont ajoutés à la liste explored.</p>
<p>Une fois la file de priorité vidée, la carte de distance est stockée dans la variable distances de l'objet graphe et renvoyée.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fast_marching_method</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">start</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">calculus_distance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">graph</span><span class="p">,</span><span class="n">weights</span><span class="p">):</span>
        <span class="n">neighbours</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_neighbours</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
        <span class="k">if</span> <span class="s1">&#39;y-1&#39;</span> <span class="ow">in</span> <span class="n">neighbours</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;y+1&#39;</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;y-1&#39;</span><span class="p">]],</span><span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;y+1&#39;</span><span class="p">]]);</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;y-1&#39;</span><span class="p">]];</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;y+1&#39;</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;y+1&#39;</span><span class="p">]];</span>
        <span class="k">if</span> <span class="s1">&#39;x-1&#39;</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;x+1&#39;</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;x-1&#39;</span><span class="p">]],</span><span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;x+1&#39;</span><span class="p">]]);</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;x-1&#39;</span><span class="p">]];</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;x+1&#39;</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="s1">&#39;x+1&#39;</span><span class="p">]];</span>

        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="n">h</span>


    <span class="n">frontier</span> <span class="o">=</span> <span class="n">PriorityQueue</span><span class="p">();</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">distances</span><span class="p">;</span>

    <span class="n">explored</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">goals</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">indicator_map</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">goals_x</span> <span class="o">=</span> <span class="n">goals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">goals_y</span> <span class="o">=</span> <span class="n">goals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">goals_x</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">frontier</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,(</span><span class="n">goals_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">goals_y</span><span class="p">[</span><span class="n">i</span><span class="p">])])</span>
        <span class="n">weights</span><span class="p">[(</span><span class="n">goals_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">goals_y</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="k">while</span> <span class="n">frontier</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">frontier</span><span class="o">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="n">explored</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#if node[1]==start:</span>
        <span class="c1">#   return weights</span>
        <span class="n">neighbours</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_neighbours</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">for</span> <span class="n">neighbour</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">neighbour</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">explored</span> <span class="ow">and</span> <span class="n">graph</span><span class="o">.</span><span class="n">indicator_map</span><span class="p">[</span><span class="n">neighbour</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">neighbour</span> <span class="ow">in</span> <span class="n">frontier</span><span class="p">:</span>
                    <span class="n">frontier</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">calculus_distance</span><span class="p">(</span><span class="n">neighbour</span><span class="p">,</span><span class="n">graph</span><span class="p">,</span><span class="n">weights</span><span class="p">),</span><span class="n">neighbour</span><span class="p">])</span>
                    <span class="n">weights</span><span class="p">[</span><span class="n">neighbour</span><span class="p">]</span><span class="o">=</span><span class="n">calculus_distance</span><span class="p">(</span><span class="n">neighbour</span><span class="p">,</span><span class="n">graph</span><span class="p">,</span><span class="n">weights</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">weights</span><span class="p">[</span><span class="n">neighbour</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">calculus_distance</span><span class="p">(</span><span class="n">neighbour</span><span class="p">,</span><span class="n">graph</span><span class="p">,</span><span class="n">weights</span><span class="p">):</span>
                    <span class="n">frontier</span><span class="p">[</span><span class="n">neighbour</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">calculus_distance</span><span class="p">(</span><span class="n">neighbour</span><span class="p">,</span><span class="n">graph</span><span class="p">,</span><span class="n">weights</span><span class="p">)</span>
                    <span class="n">weights</span><span class="p">[</span><span class="n">neighbour</span><span class="p">]</span><span class="o">=</span><span class="n">calculus_distance</span><span class="p">(</span><span class="n">neighbour</span><span class="p">,</span><span class="n">graph</span><span class="p">,</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">distances</span> <span class="o">=</span> <span class="n">weights</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">adjust_FM</p>
<p>Ce code permet d'ajuster les fronts d'onde générés par la méthode de Fast Marching.</p>
<p>Le code commence par initialiser deux listes vides, Lx_gauche et Lx_droite. Ces listes vont contenir les coordonnées des points du front d'onde qui sont à gauche ou à droite d'un point infini ou indéfini.</p>
<p>Ensuite, le code parcourt les fronts d'onde et ajoute les coordonnées des points à la liste Lx_gauche ou Lx_droite si ces points sont à gauche ou à droite d'un point infini ou indéfini. Il en fait de même pour les coordonnées des points du front d'onde qui sont en haut ou en bas d'un point infini ou indéfini, qu'il ajoute aux listes Ly_haut et Ly_bas.</p>
<p>Enfin, le code remplace les valeurs des points des fronts d'onde contenus dans les listes Lx_gauche, Lx_droite, Ly_haut et Ly_bas par les valeurs de leurs voisins les plus proches, en parcourant les listes et en accédant aux valeurs des tableaux FX et FY correspondant aux fronts d'onde en question.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">adjust_FM</span><span class="p">():</span>

    <span class="n">Lx_gauche</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Lx_droite</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">FX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">u</span> <span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="p">,</span> <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">u</span> <span class="o">==</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">!=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="n">Lx_gauche</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">==</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">u</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">u</span> <span class="o">!=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
            <span class="n">Lx_droite</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">cellule</span> <span class="ow">in</span> <span class="n">Lx_gauche</span><span class="p">:</span>
      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellule</span>
      <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">cellule</span> <span class="ow">in</span> <span class="n">Lx_droite</span><span class="p">:</span>
      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellule</span>
      <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">FX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">Ly_haut</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Ly_bas</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">FY</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>

        <span class="n">u</span> <span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="p">,</span> <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">u</span> <span class="o">==</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">!=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="n">Ly_haut</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">==</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">u</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">u</span> <span class="o">!=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
            <span class="n">Ly_bas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>


    <span class="k">for</span> <span class="n">cellule</span> <span class="ow">in</span> <span class="n">Ly_haut</span><span class="p">:</span>
      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellule</span>
      <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">cellule</span> <span class="ow">in</span> <span class="n">Ly_bas</span><span class="p">:</span>
      <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellule</span>
      <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">FY</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</code></pre></div>
<hr />
<h2 id="myagent"><strong>MyAgent</strong></h2>
<div class="admonition note">
<p class="admonition-title">myAgent</p>
<p>Ce code définit la classe <code>myAgent</code>, qui représente un agent dans notre environnement de simulation. Chaque instance de cette classe contient les attributs suivants :</p>
<p><strong><em>position:</em></strong> un vecteur 2D représentant la position de l'agent dans l'environnement.</p>
<p><strong><em>speed:</em></strong> un vecteur 2D représentant la vitesse actuelle de l'agent.</p>
<p><strong><em>D_S:</em></strong> un vecteur 2D représentant la direction désirée de l'agent (c'est-à-dire la direction vers laquelle il souhaite se déplacer).</p>
<p><strong><em>size:</em></strong> la taille de l'agent.</p>
<p><strong><em>has_reached_exit:</em></strong> un booléen qui indique si l'agent a atteint la sortie ou non.</p>
<p><strong><em>near_to_exit:</em></strong> un booléen qui indique si l'agent est proche de la sortie ou non.</p>
<p><strong><em>masse:</em></strong> la masse de l'agent.</p>
<p><strong><em>color:</em></strong> la couleur de l'agent.</p>
<p>La classe myAgent contient également plusieurs méthodes :</p>
<p><strong><em>desired_direction:</em></strong> Cette méthode calcule la direction désirée de l'agent en fonction de la position actuelle de l'agent dans l'environnement et de la carte de flux (contenue dans les matrices FX et FY).</p>
<p><strong><em>update_D_S:</em></strong> Cette méthode met à jour le vecteur D_S en appelant la méthode desired_direction.</p>
<p><strong><em>update_Speed:</em></strong> Cette méthode met à jour la vitesse de l'agent en fonction d'un vecteur de vitesse donné en argument.</p>
<p><strong><em>reach_exit:</em></strong> Cette méthode vérifie si l'agent a atteint l'une des sorties de l'environnement et met à jour l'attribut has_reached_exit en conséquence.</p>
<p><strong><em>update_Position:</em></strong> Cette méthode met à jour la position de l'agent en fonction d'un vecteur de position donné en argument et appelle la méthode reach_exit pour mettre à jour l'attribut has_reached_exit.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">myAgent</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D_S</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_reached_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">near_to_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masse</span> <span class="o">=</span> <span class="mi">80</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>

    <span class="k">def</span> <span class="nf">desired_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">size_scene</span>
        <span class="n">n</span> <span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">h</span><span class="p">)</span> <span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">FX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">FX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">FX</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">FX</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">FX</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="p">],</span> <span class="n">FY</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">v</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_D_S</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D_S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desired_direction</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update_Speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">reach_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">exits</span><span class="p">:</span>
            <span class="n">d</span> <span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">distance_vecteur_obs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">ex</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="mf">0.2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">has_reached_exit</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

    <span class="k">def</span> <span class="nf">update_Position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">q</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reach_exit</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="fonctions"><strong>Fonctions</strong></h2>
<div class="admonition note">
<p class="admonition-title">f_motrice</p>
<p>La fonction <code>f_motrice(agent)</code> calcule la force motrice qui sera appliquée à l'agent.</p>
<p>Elle prend en entrée l'objet <strong><em>agent</em></strong> qui doit posséder au moins un attribut <strong><em>D_S</em></strong> (vecteur unitaire représentant la direction désirée par l'agent) et speed (vecteur vitesse de l'agent).</p>
<p>La force motrice est calculée comme suit :</p>
<ul>
<li>
<p>Le coefficient de relaxation <strong><em>tau</em></strong> est défini à 0.5.</p>
</li>
<li>
<p>La force motrice est donnée par l'expression : (2 x direction désirée - vitesse courante) / tau</p>
</li>
<li>
<p>Le résultat est un vecteur qui représente la force motrice à appliquer à l'agent.</p>
</li>
</ul>
<p>La force motrice est la force qui pousse l'agent à suivre la direction désirée, en prenant en compte sa vitesse courante pour éviter les changements brutaux de direction. Elle permet de modéliser le comportement des agents qui avancent dans une direction donnée tout en essayant de minimiser les changements de direction brusques.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1">#force motrice</span>
<span class="k">def</span> <span class="nf">f_motrice</span><span class="p">(</span><span class="n">agent</span><span class="p">):</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">D_S</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">speed</span><span class="p">))</span><span class="o">/</span><span class="n">tau</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">dist &amp; distance_vecteur_obj &amp; distance_vecteur_obs_cir &amp; distance_vecteur_obs</p>
<p>Ces fonctions sont toutes des fonctions de calcul de distance entre deux points ou un point et un obstacle.</p>
<ul>
<li>
<p>La fonction <code>dist(p1, p2)</code> prend deux points p1 et p2 et retourne la norme de leur différence. Cette norme est calculée en utilisant la fonction numpy.array() pour créer des tableaux numpy à partir des points, puis en calculant la différence entre ces tableaux à l'aide de l'opérateur - et en utilisant la fonction norm() pour calculer la norme.</p>
</li>
<li>
<p>La fonction <code>distance_vecteur_obj(q1, q2, r1, r2)</code> prend deux points q1 et q2, ainsi que deux rayons r1 et r2 et calcule la distance entre ces deux objets. La distance est calculée comme la distance entre q1 et q2 moins la somme des rayons r1 et r2. La fonction renvoie également le vecteur normalisé allant de q2 à q1.</p>
</li>
<li>
<p>La fonction <code>distance_vecteur_obs_cir(q, r, obstacle)</code> prend un point q, un rayon r et un objet circulaire obstacle (représenté par sa position et son rayon) et calcule la distance entre le point et l'obstacle. La distance est calculée comme la distance entre le point et le centre de l'obstacle, moins la somme des rayons. La fonction renvoie également le vecteur normalisé allant du centre de l'obstacle à q.</p>
</li>
<li>
<p>La fonction <code>distance_vecteur_obs(q, r, obstacle)</code> prend un point q, un rayon r et un obstacle rectangulaire obstacle (représenté par sa position, sa largeur et sa hauteur) et calcule la distance entre le point et l'obstacle. La distance est calculée comme la distance entre q et le point de l'obstacle le plus proche de q. Ce point est calculé en projetant q sur le rectangle et en sélectionnant le point projeté qui est le plus proche de q. La fonction renvoie également le vecteur normalisé allant du point le plus proche de q sur l'obstacle à q.</p>
</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">norm</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">distance_vecteur_obj</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span><span class="o">/</span><span class="n">d</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">d</span> <span class="p">,</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">distance_vecteur_obs_cir</span><span class="p">(</span><span class="n">q</span> <span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">):</span>
    <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">],</span> <span class="n">rayon</span> <span class="o">=</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">rayon</span>
    <span class="n">x</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">q</span>

    <span class="n">d</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">b0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> 
    <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q</span><span class="p">))</span><span class="o">/</span><span class="n">d</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="n">rayon</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">d</span> <span class="p">,</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">distance_vecteur_obs</span><span class="p">(</span><span class="n">q</span> <span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">):</span>
    <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">],</span> <span class="n">L</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">height</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">L</span> <span class="p">,</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">l</span>
    <span class="n">x</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">q</span>
    <span class="n">point</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;=</span><span class="n">a0</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">y</span><span class="o">&gt;=</span><span class="n">b1</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b1</span><span class="p">]</span>

      <span class="k">elif</span> <span class="n">b0</span><span class="o">&lt;</span><span class="n">y</span><span class="o">&lt;</span><span class="n">b1</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">a0</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&lt;</span><span class="n">a1</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">y</span><span class="o">&gt;=</span><span class="n">b1</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">b1</span><span class="p">]</span>

      <span class="k">elif</span> <span class="n">b0</span><span class="o">&lt;</span><span class="n">y</span><span class="o">&lt;</span><span class="n">b1</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">b1</span><span class="p">]</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">b0</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">y</span><span class="o">&gt;=</span><span class="n">b1</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">]</span>

      <span class="k">elif</span> <span class="n">b0</span><span class="o">&lt;</span><span class="n">y</span><span class="o">&lt;</span><span class="n">b1</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">b0</span><span class="p">]</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">point</span> <span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">point</span><span class="p">))</span><span class="o">/</span><span class="n">d</span>

    <span class="k">return</span> <span class="n">d</span> <span class="o">-</span> <span class="n">r</span> <span class="p">,</span> <span class="n">n</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">matrice_normals</p>
<p>Cette fonction <code>matrice_normals(q, R)</code> calcule les vecteurs normaux pour chaque collision possible entre les agents et les obstacles dans un environnement donné.</p>
<p>La fonction prend en entrée deux listes : q qui est la liste des positions des agents et R qui est la liste des rayons de chaque agent.</p>
<p>La fonction retourne une matrice numpy, Normals, qui contient les vecteurs normaux de chaque collision, où chaque ligne représente un vecteur normal pour un choc possible et chaque colonne représente un agent (donc 2*m colonnes pour m agents). La fonction retourne également une liste, agents_en_chocs, qui contient les indices des agents impliqués dans au moins une collision.</p>
<p>La fonction parcourt tous les agents et vérifie s'il y a une collision avec un autre agent ou un obstacle. Si une collision est détectée, la fonction calcule le vecteur normal correspondant à cette collision à l'aide de <strong><em>distance_vecteur_obj()</em></strong> pour une collision entre deux agents, distance_vecteur_obs() pour une collision entre un agent et un obstacle rectangulaire et <strong><em>distance_vecteur_obs_cir()</em></strong> pour une collision entre un agent et un obstacle circulaire.</p>
<p>Les vecteurs normaux sont stockés dans la matrice Normals et les indices des agents impliqués dans des collisions sont stockés dans la liste agents_en_chocs.</p>
<p>En fin de parcours, la fonction renvoie la matrice Normals et la liste agents_en_chocs.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">matrice_normals</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>

    <span class="n">Normals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">agents_en_chocs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

    <span class="c1">#chocs agents</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>

        <span class="n">N</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">d</span> <span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">distance_vecteur_obj</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="mf">0.2</span><span class="p">:</span>
              <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">N</span><span class="p">):</span>
          <span class="n">Normals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
          <span class="n">agents_en_chocs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="c1">#chocs obstacle</span>
    <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>

        <span class="n">N</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
          <span class="n">d</span> <span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">distance_vecteur_obs</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">obstacle</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="mf">0.2</span><span class="p">:</span>
            <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">agents_en_chocs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">N</span><span class="p">):</span>
          <span class="n">Normals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c1">#chocs obstacle circulaire</span>
    <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles_cir</span><span class="p">:</span>

        <span class="n">N</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
          <span class="n">d</span> <span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">distance_vecteur_obs_cir</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">obstacle</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="mf">.2</span><span class="p">:</span>
            <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">agents_en_chocs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">N</span><span class="p">):</span>
          <span class="n">Normals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Normals</span><span class="p">)</span> <span class="p">,</span> <span class="n">agents_en_chocs</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">detection_de_chocs</p>
<p>La fonction <code>detection_de_chocs(Q, R)</code> qui prend en entrée deux listes Q et R contenant respectivement les positions et les rayons de tous les agents et qui renvoie True si deux agents ou un agent et un obstacle se trouvent à une distance inférieure à une marge de collision marge, et False sinon.</p>
<p>La fonction parcourt d'abord tous les obstacles rectangulaires et circulaires stockés dans les variables obstacles et obstacles_cir, respectivement, pour vérifier s'il y a une collision entre l'agent et l'un de ces obstacles en comparant les coordonnées de l'agent à celles des coins de l'obstacle et à la distance de l'agent au centre de l'obstacle. Ensuite, la fonction compare la distance entre l'agent courant et tous les autres agents pour vérifier s'il y a une collision entre eux.</p>
<p>Si une collision est détectée, la fonction retourne True, sinon elle retourne False.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">detection_de_chocs</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>

  <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="p">[</span><span class="n">x</span> <span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">marge</span> <span class="o">=</span> <span class="mf">.2</span>

    <span class="c1">#chocs obstacle</span>
    <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
        <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">],</span> <span class="n">L</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">obstacle</span><span class="o">.</span><span class="n">height</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">L</span> <span class="p">,</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">l</span>

        <span class="k">if</span> <span class="n">a0</span><span class="o">&lt;=</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">a1</span> <span class="ow">and</span> <span class="n">b0</span><span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="n">marge</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">b1</span><span class="o">+</span><span class="n">r</span><span class="o">+</span><span class="n">marge</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">b0</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">b1</span> <span class="ow">and</span> <span class="n">a0</span><span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="n">marge</span><span class="o">&lt;=</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">a1</span><span class="o">+</span><span class="n">r</span><span class="o">+</span><span class="n">marge</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">obst</span> <span class="ow">in</span> <span class="n">obstacles_cir</span><span class="p">:</span>
        <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">],</span> <span class="n">rayon</span> <span class="o">=</span> <span class="n">obst</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">obst</span><span class="o">.</span><span class="n">rayon</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">b0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="n">rayon</span><span class="o">+</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>

    <span class="c1">#chocs agents</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dist</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">marge</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>

  <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">predict_position2</p>
<p>La fonction <code>predict_position2(V)</code> permet de prédire la position des agents à l'instant suivant en fonction de leur vitesse actuelle et leur vitesse future, ainsi que de leur position actuelle. Elle prend en entrée une liste V de la vitesse de chaque agent (vecteur de dimension 2 pour chaque agent) à l'instant actuel.</p>
<p>Le premier élément de la fonction convertit la liste V en un tableau V_future de dimension p x 2 où p est le nombre d'agents dans la simulation. Chaque ligne de V_future contient la vitesse future d'un agent sous la forme d'un vecteur de dimension 2.</p>
<p>Le deuxième élément de la fonction crée un tableau V_passe de dimension m x 2, où m est le nombre total d'agents dans la simulation. Chaque ligne de V_passe contient la vitesse actuelle de chaque agent sous la forme d'un vecteur de dimension 2.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">predict_position2</span><span class="p">(</span><span class="n">V</span><span class="p">):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">V_future</span> <span class="o">=</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">])</span>
  <span class="n">V_passe</span> <span class="o">=</span>   <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span> <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span> <span class="p">])</span>

  <span class="k">return</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">V_future</span><span class="p">[</span><span class="n">agents</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">agent</span><span class="p">)]</span> <span class="o">+</span> <span class="n">V_passe</span><span class="p">[</span><span class="n">agents</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">agent</span><span class="p">)])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">]</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">correction_vitesses</p>
<p>Cette fonction prend en entrée la vitesse actuelle de chaque agent, la force extérieure appliquée à chaque agent et le coefficient de restitution entre les agents. Elle calcule ensuite la nouvelle vitesse pour chaque agent en fonction des chocs détectés en appelant la fonction <strong><em>matrice_normals</em></strong> qui retourne la matrice des normales pour chaque agent en collision avec un autre agent ou un obstacle.</p>
<p>Dans la première partie de la fonction, la fonction predict_position2 est appelée pour prédire la position future des agents. Ensuite, la fonction <strong><em>detection_de_chocs</em></strong> est appelée pour vérifier s'il y a collision entre les agents et les obstacles.</p>
<p>Si une collision est détectée, la fonction calcule la matrice de masse M pour chaque agent et la matrice de normales C_N pour chaque collision. Ensuite, elle calcule la matrice U en multipliant la transposée de C_N avec C_N. Cette matrice est utilisée pour calculer la matrice de contrainte P.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">correction_vitesses</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">Pext</span><span class="p">,</span> <span class="n">K_n</span><span class="p">):</span>
    <span class="n">V</span><span class="p">,</span> <span class="n">Pext</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Pext</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>
    <span class="n">agents_en_chocs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">predict_position2</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">agent</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">detection_de_chocs</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="c1"># Matrice Masse</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
            <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">agents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">masse</span>
            <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">agents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">masse</span>

        <span class="c1"># Matrice Normales</span>
        <span class="n">C_N</span> <span class="p">,</span> <span class="n">agents_en_chocs</span> <span class="o">=</span> <span class="n">matrice_normals</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>

        <span class="n">U</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">C_N</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">C_N</span><span class="p">)</span>

        <span class="n">P</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">K_n</span> <span class="o">*</span> <span class="n">U</span> <span class="p">,</span> <span class="n">tc</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">K_n</span> <span class="o">*</span> <span class="n">U</span> <span class="p">,</span> <span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">Pext</span><span class="p">),</span> <span class="n">tc</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">C_N</span><span class="p">),</span> <span class="n">tc</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">C_N</span><span class="p">))),</span> <span class="n">tc</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>

        <span class="n">solvers</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;show_progress&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">solvers</span><span class="o">.</span><span class="n">qp</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="o">-</span><span class="n">q</span><span class="p">,</span><span class="o">-</span><span class="n">G</span><span class="p">,</span><span class="n">h</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span> <span class="p">,</span> <span class="n">agents_en_chocs</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">V</span> <span class="p">,</span> <span class="n">agents_en_chocs</span>
</code></pre></div>
<hr />
<div class="admonition note">
<p class="admonition-title">matrice_DistancesEtNormaux &amp; matrice_DistancesEtNormaux_danger</p>
<p>Ces deux fonctions génèrent une matrice de distances et une matrice de normales entre les agents (ou les dangers) du scénario.</p>
<p>La fonction <code>matrice_DistancesEtNormaux(agents)</code> prend en entrée une liste d'objets agents et renvoie une matrice de distance matrice_distance et une matrice de normales matrice_normaux. Les matrices sont carrées et de taille égale au nombre d'agents dans la liste agents. La matrice de distance matrice_distance contient les distances entre chaque paire d'agents, et la matrice de normales matrice_normaux contient les normales correspondantes.</p>
<p>La fonction <code>matrice_DistancesEtNormaux_danger(agents)</code> prend en entrée une liste d'objets agents et renvoie une matrice de distance matrice_distance et une matrice de normales matrice_normaux entre chaque agent de la liste et le danger Dangers[0]. La matrice de distance matrice_distance contient les distances entre chaque agent et le danger, et la matrice de normales matrice_normaux contient les normales correspondantes.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">matrice_DistancesEtNormaux</span><span class="p">(</span><span class="n">agents</span><span class="p">):</span>
    <span class="n">N_ind</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>
    <span class="n">matrice_distance</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_ind</span><span class="p">,</span> <span class="n">N_ind</span><span class="p">))</span>
    <span class="n">matrice_normaux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_ind</span><span class="p">,</span> <span class="n">N_ind</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_ind</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_ind</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">d</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">distance_vecteur_obj</span><span class="p">(</span><span class="n">agents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">agents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">agents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">agents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
                <span class="n">matrice_distance</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
                <span class="n">matrice_distance</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
                <span class="n">matrice_normaux</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
                <span class="n">matrice_normaux</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span>
    <span class="k">return</span> <span class="n">matrice_distance</span> <span class="p">,</span> <span class="n">matrice_normaux</span>

<span class="k">def</span> <span class="nf">matrice_DistancesEtNormaux_danger</span><span class="p">(</span><span class="n">agents</span><span class="p">):</span>
    <span class="n">N_ind</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>
    <span class="n">matrice_distance</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_ind</span><span class="p">)</span>
    <span class="n">matrice_normaux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_ind</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_ind</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">Dangers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">agents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Dangers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">agents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>
        <span class="n">matrice_distance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">matrice_normaux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">matrice_distance</span> <span class="p">,</span> <span class="n">matrice_normaux</span>
</code></pre></div>
<hr />
<h2 id="configuration"><strong>Configuration</strong></h2>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="p">,</span> <span class="n">b</span> <span class="p">,</span> <span class="n">eps</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">,</span> <span class="mf">0.2</span>
<span class="n">size_scene</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="n">obstacles</span> <span class="o">=</span> <span class="p">[</span><span class="n">Obstacle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">eps</span><span class="p">),</span> <span class="n">Obstacle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">eps</span><span class="p">),</span><span class="n">eps</span><span class="p">,</span><span class="n">b</span><span class="o">-</span><span class="n">eps</span><span class="p">),</span> <span class="n">Obstacle</span><span class="p">((</span><span class="n">eps</span><span class="p">,</span><span class="n">b</span><span class="o">-</span><span class="n">eps</span><span class="p">),</span><span class="n">a</span><span class="o">-</span><span class="n">eps</span><span class="p">,</span><span class="n">eps</span><span class="p">),</span> <span class="n">Obstacle</span><span class="p">((</span><span class="n">a</span><span class="o">-</span><span class="n">eps</span><span class="p">,</span> <span class="n">eps</span><span class="p">),</span><span class="n">eps</span><span class="p">,</span> <span class="n">b</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">eps</span><span class="p">)]</span>

<span class="n">exits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Exit</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="o">-</span><span class="n">eps</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="p">)]</span>

<span class="n">obstacles_cir</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">draw</span><span class="p">(</span><span class="n">exits</span><span class="p">,</span> <span class="n">obstacles</span><span class="p">,</span> <span class="n">obstacles_cir</span><span class="p">,</span> <span class="n">size_scene</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;gemoetrie.png&#39;</span><span class="p">,</span> <span class="n">play</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<details class="output">
<summary>Output</summary>
<p><img alt="image" src="../../assets/images/download.png" /></p>
</details>
<h2 id="champs-de-directions"><strong>Champs de directions</strong></h2>
<div class="highlight"><pre><span></span><code><span class="n">h</span> <span class="o">=</span> <span class="mf">.5</span> <span class="c1">#pas de discritisation du FAst Marching</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">GridGraph</span><span class="p">(</span><span class="n">size_scene</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>

<span class="n">graph</span><span class="o">.</span><span class="n">prepare_graph_for_fast_marching</span><span class="p">(</span><span class="n">obstacles</span><span class="p">,</span> <span class="n">obstacles_cir</span><span class="p">,</span> <span class="n">exits</span><span class="p">)</span>

<span class="n">fast_marching_method</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">d</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">distances</span>
<span class="n">d_tr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">d_tr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">FY</span><span class="p">,</span> <span class="n">FX</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d_tr</span><span class="p">))</span>

<span class="n">FX</span> <span class="o">=</span> <span class="o">-</span><span class="n">FX</span>

<span class="n">adjust_FM</span><span class="p">()</span>
</code></pre></div>
<details class="output">
<summary>Output</summary>
<p><img alt="image" src="../../assets/images/2.png" /></p>
</details>
<h2 id="simulation"><strong>Simulation</strong></h2>
<div class="highlight"><pre><span></span><code><span class="n">N_pop</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">temps_de_sim</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="mi">60</span> <span class="c1">#secondes</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">5e-2</span>
<span class="n">N_iter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temps_de_sim</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">agents</span> <span class="o">=</span> <span class="n">generate_indiv</span><span class="p">(</span><span class="n">N_pop</span><span class="p">)</span>

<span class="n">draw</span><span class="p">(</span><span class="n">exits</span><span class="p">,</span> <span class="n">obstacles</span><span class="p">,</span> <span class="n">obstacles_cir</span><span class="p">,</span> <span class="n">size_scene</span><span class="p">,</span> <span class="n">agents</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;config_init.png&#39;</span><span class="p">,</span> <span class="n">play</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<details class="output">
<summary>Output</summary>
<p><img alt="image" src="../../assets/images/3.png" /></p>
</details>
<div class="highlight"><pre><span></span><code><span class="n">K_n</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">agent</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">]</span>

<span class="err">!</span><span class="n">mkdir</span> <span class="n">DossierImages</span>
<span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;DossierImages&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;DossierImages/&#39;</span> <span class="o">+</span> <span class="n">image</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_iter</span><span class="p">)):</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span><span class="k">break</span>

    <span class="n">V_avant_correction</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">P</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">matrice_distance</span> <span class="p">,</span> <span class="n">matrice_normaux</span> <span class="o">=</span> <span class="n">matrice_DistancesEtNormaux</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>

        <span class="n">agent</span><span class="o">.</span><span class="n">update_D_S</span><span class="p">()</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">f_motrice</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
        <span class="n">vi</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">speed</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">p_ext</span><span class="o">/</span><span class="n">agent</span><span class="o">.</span><span class="n">masse</span>
        <span class="n">V_avant_correction</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">vi</span><span class="p">)</span>
        <span class="n">P</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p_ext</span><span class="p">)</span>

    <span class="n">V_new</span> <span class="p">,</span> <span class="n">agents_en_chocs</span> <span class="o">=</span> <span class="n">correction_vitesses</span><span class="p">(</span><span class="n">V_avant_correction</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">K_n</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">predict_position2</span><span class="p">(</span><span class="n">V_new</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">agents</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">update_Speed</span><span class="p">([</span><span class="n">V_new</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span> <span class="n">V_new</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">agent</span><span class="o">.</span><span class="n">update_Position</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">agent</span><span class="o">.</span><span class="n">has_reached_exit</span><span class="p">:</span> <span class="n">agents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>

    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;DossierImages/simulation&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
    <span class="n">draw</span><span class="p">(</span><span class="n">exits</span><span class="p">,</span> <span class="n">obstacles</span><span class="p">,</span> <span class="n">obstacles_cir</span><span class="p">,</span> <span class="n">size_scene</span><span class="p">,</span> <span class="n">agents</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">savepath</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">play</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Simulation finished.&#39;</span><span class="p">)</span>
<span class="n">record_video</span><span class="p">(</span><span class="n">speed</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
</code></pre></div>
<details class="output">
<summary>Output</summary>
<p><img alt="video" src="../../assets/videos/video.gif" /></p>
</details>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../projet%20R/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Profilage des chauffeurs" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Profilage des chauffeurs
              </div>
            </div>
          </a>
        
        
          
          <a href="../Painting%20Vermeer/" class="md-footer__link md-footer__link--next" aria-label="Next: Algorithmes Génétiques 2, Peindre Vermeer" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Algorithmes Génétiques 2, Peindre Vermeer
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 - 2023 MOUHIHA MOHAMED
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/mouhihamohamed702" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/mouhiha-mohamed-a0657b1a3/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "content.action.edit", "content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "navigation.footer"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>